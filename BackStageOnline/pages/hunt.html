<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>海蜂后台-马上找人</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="renderer" content="webkit" />

    <link rel="stylesheet" href="../style/normalize.css">
    <link rel="stylesheet" href="../style/main.css">
    <link rel="stylesheet" href="../plugin/Pagination/pagination.css">
    <script src="../js/jquery.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../plugin/lhgdialog/lhgdialog.min.js"></script>
    <script type="text/javascript" src="../plugin/Pagination/jquery.pagination.js"></script>
</head>
<body>
    <div class="content-panel">
        <div class="panel-top">
            <h3>马上找人</h3>
        </div>
        <div class="hunttop clearfix">
            <div class="huntleft fl">
                <ul class="htleft-menu">
                     <li>
                        <label class="default-label fl">岗位范围</label>
                        <div class="hiretype-container fl">
                            <span class="icon icon-arrow" id="chooseSpan">选择</span>
                            <div class="hiretype-content">
                                <p class="hiretype-infor lf">
                                    请选择要招聘的岗位
                                    <span class="fr">
                                        当前行业：
                                        <small>餐饮</small>
                                    </span>
                                </p>
                                <div>
                                    <a href="javascript:void(0);" class="hiretype" data-index="0" onclick="addMark($(this))">迎宾1</a>
                                    <a href="javascript:void(0);" class="hiretype" data-index="1" onclick="addMark($(this))">迎宾2</a>
                                    <a href="javascript:void(0);" class="hiretype" data-index="2" onclick="addMark($(this))">迎宾3</a>
                                    <a href="javascript:void(0);" class="hiretype" data-index="3" onclick="addMark($(this))">迎宾4</a>
                                    
                                    <a href="javascript:void(0);" class="hiretype" data-index="4" onclick="addMark($(this))">迎宾5</a>
                                    <a href="javascript:void(0);" class="hiretype" data-index="5" onclick="addMark($(this))">迎宾6</a>
                                </div>
                                <p class="lf">
                                    <button class="confirm-type fr">确定</button>
                                </p>
                            </div>
                        </div>
                        <div class="choose-result fl" id="chooseResult"></div>
                    </li>
                    <li>
                        <label class="default-label fl">岗位地点</label>
                        <select class="fl">
                            <option option="option1">选择</option>
                            <option option="option2">选择2</option>
                            <option option="option3">选择3</option>
                        </select>
                        <input type="text" class="input-320">
                        <div>
                            <ul>
                                <li>
                                    <a href=""></a>
                                </li>
                                <li>
                                    <a href=""></a>
                                </li>
                                <li>
                                    <a href=""></a>
                                </li>
                                <li>
                                    <a href=""></a>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="huntmid fl">
                <ul class="htmid-menu">
                    <li>
                        <label class="default-label">简历</label>
                        <p>
                            <input type="checkbox" name="resume">有照片</p>
                        <p>
                            <input type="checkbox" name="resume">有视频</p>
                    </li>
                    <li>
                        <label class="default-label">性别</label>
                        <p>
                            <input type="radio" name="gender" checked>不限</p>
                        <p>
                            <input type="radio" name="gender">男</p>
                        <p>
                            <input type="radio" name="gender">女</p>
                    </li>
                    <li>
                        <label class="default-label">年龄</label>
                        <p>
                            <input type="radio" name="age" checked>不限</p>
                        <p class="agep">
                            <input type="radio" name="age">自定义
                            <input type="number">
                            <span>至</span>
                            <input type="number"></p>
                    </li>
                    <li>
                        <label class="default-label">工作</label>
                        <p>
                            <input type="radio" name="jobtype" checked>全职</p>
                        <p>
                            <input type="radio" name="jobtype">兼职</p>
                    </li>
                </ul>
            </div>
            <p class="btnp fl">
                <button type="button">查找</button>
            </p>
        </div>
        <div class="hunt-pepole clearfix">
            <div class="sigle-content clearfix">
                <div class="single clearfix fl">
                    <div class="single-image fl">
                        <img src="../images/female.png">
                        <a href="javascript:void(0);" class="withdetail">
                            <span class="icon icon-picture"></span>
                        </a>
                        <a href="javascript:void(0);" class="withdetail">
                            <span class="icon icon-video"></span>
                        </a>
                    </div>
                    <ul class="single-menu fl">
                        <li>
                            <label>姓名：</label>
                            <span>高司令</span>
                            <a href="" class="fr">
                                <span class="icon icon-women"></span>
                                18岁
                            </a>
                        </li>
                        <li>
                            <label>岗位：</label>
                            <span>服务员</span>
                        </li>
                        <li>
                            <label>距离：</label>
                            <span>2kg以内</span>
                        </li>
                        <li>
                            <label>位置：</label>
                            <span>西溪花园水岸花苑</span>
                        </li>
                        <li>
                            <p class="btnp">
                                <button type="button" onclick="dialogModality('pages/tipsbox.html?tip=可用看点不足，马上去补充吧！&img=inforicon','提示',['375px','134px'],['继续看']);"><span class="icon icon-lock"></span>我要看</button>
                            </p>
                        </li>
                    </ul>
                </div>
                <div class="single clearfix fl">
                    <div class="single-image fl">
                        <img src="../images/female.png">
                        <a href="javascript:void(0);">
                            <span class="icon icon-picture"></span>
                        </a>
                        <a href="javascript:void(0);">
                            <span class="icon icon-video"></span>
                        </a>
                    </div>
                    <ul class="single-menu fl">
                        <li>
                            <label>姓名：</label>
                            <span>高司令</span>
                            <a href="" class="fr">
                                <span class="icon icon-women"></span>
                                18岁
                            </a>
                        </li>
                        <li>
                            <label>岗位：</label>
                            <span>服务员</span>
                        </li>
                        <li>
                            <label>距离：</label>
                            <span>2kg以内</span>
                        </li>
                        <li>
                            <label>位置：</label>
                            <span>西溪花园水岸花苑</span>
                        </li>
                        <li>
                            <p class="btnp">
                                <button type="button" onclick="dialogModality('pages/tipsbox.html?tip=可用看点不足，马上去补充吧！&img=inforicon','提示',['375px','134px'],['继续看']);"><span class="icon icon-lock"></span>我要看</button>
                            </p>
                        </li>
                    </ul>
                </div>
                <div class="single clearfix fl">
                    <div class="single-image fl">
                        <img src="../images/female.png">
                        <a href="javascript:void(0);">
                            <span class="icon icon-picture"></span>
                        </a>
                        <a href="javascript:void(0);">
                            <span class="icon icon-video"></span>
                        </a>
                    </div>
                    <ul class="single-menu fl">
                        <li>
                            <label>姓名：</label>
                            <span>高司令</span>
                            <a href="" class="fr">
                                <span class="icon icon-women"></span>
                                18岁
                            </a>
                        </li>
                        <li>
                            <label>岗位：</label>
                            <span>服务员</span>
                        </li>
                        <li>
                            <label>距离：</label>
                            <span>2kg以内</span>
                        </li>
                        <li>
                            <label>位置：</label>
                            <span>西溪花园水岸花苑</span>
                        </li>
                        <li>
                            <p class="btnp">
                                <button type="button" onclick="dialogModality('pages/tipsbox.html?tip=可用看点不足，马上去补充吧！&img=inforicon','提示',['375px','134px'],['继续看']);"><span class="icon icon-lock"></span>我要看</button>
                            </p>
                        </li>
                    </ul>
                </div>
                <div class="single clearfix fl">
                    <div class="single-image fl">
                        <img src="../images/female.png">
                        <a href="javascript:void(0);">
                            <span class="icon icon-picture"></span>
                        </a>
                        <a href="javascript:void(0);">
                            <span class="icon icon-video"></span>
                        </a>
                    </div>
                    <ul class="single-menu fl">
                        <li>
                            <label>姓名：</label>
                            <span>高司令</span>
                            <a href="" class="fr">
                                <span class="icon icon-women"></span>
                                18岁
                            </a>
                        </li>
                        <li>
                            <label>岗位：</label>
                            <span>服务员</span>
                        </li>
                        <li>
                            <label>距离：</label>
                            <span>2kg以内</span>
                        </li>
                        <li>
                            <label>位置：</label>
                            <span>西溪花园水岸花苑</span>
                        </li>
                        <li>
                            <p class="btnp">
                                <button type="button" onclick="dialogModality('pages/tipsbox.html?tip=可用看点不足，马上去补充吧！&img=inforicon','提示',['375px','134px'],['继续看']);"><span class="icon icon-lock"></span>我要看</button>
                            </p>
                        </li>
                    </ul>
                </div>
                <div class="single clearfix fl">
                    <div class="single-image fl">
                        <img src="../images/male.png">
                        <a href="javascript:void(0);">
                            <span class="icon icon-picture"></span>
                        </a>
                        <a href="javascript:void(0);">
                            <span class="icon icon-video"></span>
                        </a>
                    </div>
                    <ul class="single-menu fl">
                        <li>
                            <label>姓名：</label>
                            <span>高司令</span>
                            <a href="" class="fr">
                                <span class="icon icon-man"></span>
                                18岁
                            </a>
                        </li>
                        <li>
                            <label>岗位：</label>
                            <span>服务员</span>
                        </li>
                        <li>
                            <label>距离：</label>
                            <span>2kg以内</span>
                        </li>
                        <li>
                            <label>位置：</label>
                            <span>西溪花园水岸花苑</span>
                        </li>
                        <li>
                            <p class="btnp">
                                <button type="button" onclick="dialogModality('pages/tipsbox.html?tip=可用看点不足，马上去补充吧！&img=inforicon','提示',['375px','134px'],['继续看']);"><span class="icon icon-lock"></span>我要看</button>
                            </p>
                        </li>
                    </ul>
                </div>
                <div class="single clearfix fl">
                    <div class="single-image fl">
                        <img src="../images/female.png">
                        <a href="javascript:void(0);">
                            <span class="icon icon-picture"></span>
                        </a>
                        <a href="javascript:void(0);">
                            <span class="icon icon-video"></span>
                        </a>
                    </div>
                    <ul class="single-menu fl">
                        <li>
                            <label>姓名：</label>
                            <span>高司令</span>
                            <a href="" class="fr">
                                <span class="icon icon-women"></span>
                                18岁
                            </a>
                        </li>
                        <li>
                            <label>岗位：</label>
                            <span>服务员</span>
                        </li>
                        <li>
                            <label>距离：</label>
                            <span>2kg以内</span>
                        </li>
                        <li>
                            <label>位置：</label>
                            <span>西溪花园水岸花苑</span>
                        </li>
                        <li>
                            <p class="btnp">
                                <button type="button" onclick="dialogModality('pages/tipsbox.html?tip=可用看点不足，马上去补充吧！&img=inforicon','提示',['375px','134px'],['继续看']);"><span class="icon icon-lock"></span>我要看</button>
                            </p>
                        </li>
                    </ul>
                </div>
                <div class="single clearfix fl">
                    <div class="single-image fl">
                        <img src="../images/male.png">
                        <a href="javascript:void(0);">
                            <span class="icon icon-picture"></span>
                        </a>
                        <a href="javascript:void(0);">
                            <span class="icon icon-video"></span>
                        </a>
                    </div>
                    <ul class="single-menu fl">
                        <li>
                            <label>姓名：</label>
                            <span>高司令</span>
                            <a href="" class="fr">
                                <span class="icon icon-man"></span>
                                18岁
                            </a>
                        </li>
                        <li>
                            <label>岗位：</label>
                            <span>服务员</span>
                        </li>
                        <li>
                            <label>距离：</label>
                            <span>2kg以内</span>
                        </li>
                        <li>
                            <label>位置：</label>
                            <span>西溪花园水岸花苑</span>
                        </li>
                        <li>
                            <p class="btnp">
                                <button type="button" onclick="dialogModality('pages/tipsbox.html?tip=可用看点不足，马上去补充吧！&img=inforicon','提示',['375px','134px'],['继续看']);"><span class="icon icon-lock"></span>我要看</button>
                            </p>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="pages">
                <ul>
                    <li class="pagesli1">
                        <a href="javascript:void(0);"></a>
                    </li>
                    <li class="pagesli2">
                        <a href="javascript:void(0);"></a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">1</a>
                    </li>
                    <li class="pagesli3 pageactive">
                        <a href="javascript:void(0);">2</a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">3</a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">4</a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">5</a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">6</a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">7</a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">...</a>
                    </li>
                    <li class="pagesli3">
                        <a href="javascript:void(0);">21</a>
                    </li>
                    <li class="pagesli4">
                        <a href="javascript:void(0);"></a>
                    </li>
                    <li class="pagesli5">
                        <a href="javascript:void(0);"></a>
                    </li>
                    <li class="pagesli6">
                        <input type="number">
                        <button></button>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var iDataCount = 9;
        var pagesize = 9;
        var pageindex = 1;
        var allresume = null;
        function getpositiondata() {
            var html = "";

            $.each(window.parent.oIndustryAndPosition.Industrys, function (n, value) {
                if (value.Id === window.parent.oUserInfo.Industry) {
                    $("#myindustry").html(value.IndustryName);
                }
            });
            $.each(window.parent.oIndustryAndPosition.Positions, function (n, value) {
                if (value.IndustryId === window.parent.oUserInfo.Industry) {
                    if (window.parent.oUserInfo.Position.indexOf(value.Id) !== -1) {
                        html += '<a href="javascript:void(0);" class="hiretype choosemark" data-index="' + value.Id + '" onclick="addMark($(this))">' + value.PositionName + '</a>';
                        $("#chooseResult").append('<a href=\"javascript:void(0);\" data-rtIndex=' + value.Id + ' onclick=\"delResult($(this))\">' + value.PositionName + '<span>×</span> </a>');
                    } else {
                        html += '<a href="javascript:void(0);" class="hiretype" data-index="' + value.Id + '" onclick="addMark($(this))">' + value.PositionName + '</a>';
                    }

                }
            });
            $("#apositions").html(html);
        }
        function getpositionname(positionid) {
            var v = "";
            var s = positionid.split(',');
            for (var i = 0; i < s.length; i++) {
                for (var j = 0; j < window.parent.oIndustryAndPosition.Positions.length; j++) {
                    if (s[i] == window.parent.oIndustryAndPosition.Positions[j].Id) {
                        if (v == "")
                            v = window.parent.oIndustryAndPosition.Positions[j].PositionName;
                        else
                            v += "," + window.parent.oIndustryAndPosition.Positions[j].PositionName;
                    }
                }
            }
            return v;
        }
        $(function () {
            var oUserInfo = window.parent.oUserInfo;
            if (oUserInfo !== null) {
                $('#txtLocation').val(oUserInfo.Location === '' ? '' : oUserInfo.Location);
                getpositiondata();

                $("#divcontent").hide();
                $("#divnolist").show();
                //初始化地图
                var map = new AMap.Map("container", {
                    resizeEnable: true
                });
                //为地图注册click事件获取鼠标点击出的经纬度坐标
                //var clickEventListener = map.on('click', function (e) {
                //    document.getElementById("lnglat").value = e.lnglat.getLng() + ',' + e.lnglat.getLat();
                //});
                var auto = new AMap.Autocomplete({
                    input: "txtLocation"
                });
                AMap.event.addListener(auto, "select", select); //注册监听，当选中某条记录时会触发
                function select(e) {
                    if (e.poi && e.poi.location) {
                        //map.setZoom(15);
                        //map.setCenter(e.poi.location);
                    }
                    //经纬度获取
                    $("#txtLocation").val(e.poi.name);
                    $("#hidLng").val(e.poi.location.lng);
                    $("#hidLat").val(e.poi.location.lat);
                }
            }
        });
        //resumelist
        $("#btnSearch").click(function () {
            fShowdata(0, null);
        });
        $("#sage,#eage").focus(function () {
            $("input[name='age']").eq(1).attr("checked", "checked");
        });

        function fShowdata(page_index, jq) {
            page_index = page_index + 1;
            var sage = 0;
            var eage = 0;
            var position = "";
            var choosePositions = $("#chooseResult a");
            if (choosePositions != undefined && choosePositions != null) {
                $.each(choosePositions, function (n, value) {
                    position += $(value).attr("data-rtindex") + ",";
                });
            }
            if (position !== "") {
                position = position.substr(0, position.length - 1);
            } else {
                alert("请选择岗位");
                return;
            }
            var longitude;
            var latitude
            var haspic = $("#pic").prop("checked");
            var hasvideo = $("#video").prop("checked");
            var sex = $('input[name="gender"]:checked').val();
            var age = $('input[name="age"]:checked').val();
            if (age == 1) {
                if ($("#sage").val() == "") {
                    alert("请填写年纪");
                    $("#sage").focus();
                    return;
                }
                if ($("#eage").val() == "") {
                    alert("请填写年纪");
                    $("#eage").focus();
                    return;
                }
                sage = $("#sage").val();
                eage = $("#eage").val();
            }
            var jobnature = $('input[name="jobtype"]:checked').val();
            $.post('/Ajax/MerchantCenter/FindTalents.ashx', { action: 'SearchResumes', data: "{\"pagesize\":\"" + pagesize + "\",\"pageindex\":\"" + page_index + "\",\"sex\":\"" + sex + "\",\"position\":\"" + position + "\",\"haspic\":\"" + haspic + "\",\"hasvideo\":\"" + hasvideo + "\",\"startage\":\"" + sage + "\",\"endage\":\"" + eage + "\",\"longitude\":\"" + longitude + "\",\"latitude\":\"" + latitude + "\",\"jobnature\":\"" + jobnature + "\"}" }, function (resp) {
                if (resp.code === "1000") {
                    allresume = resp.data;

                    if (allresume.Total > 0) {
                        $("#divcontent").show();
                        $("#divnolist").hide();

                        var temp = '<div class="single clearfix fl"><div class="single-image fl"><img src="{$logo}"><a href="javascript:void(0)" class="{$pic}"><span class="icon icon-picture"></span>' +
                            '</a><a href="javascript:void(0)" class="{$video}"><span class="icon icon-video"></span></a></div><ul class="single-menu fl"><li><label>姓名：</label><span>{$name}</span>' +
                            '<a href="" class="fr"><span class="{$sex}"></span>{$age}岁</a></li><li><label>岗位：</label><span>{$position}</span>' +
                            '</li><li><label>距离：</label><span>{$distance}以内</span></li><li><label>位置：</label><span>{$location}</span></li><li><p class="btnp">' +
                            '<button type="button" class=" icon-lock" onclick=dialogModality("/pages/details.html?id={$id}&accid={$accid}","简历详情",["1000px","564px"],["继续看"]);>我要看</button></p></li></ul></div>';
                        var html = "";
                        $("#resumelist").html(html);
                        console.log(allresume);
                        for (var i = 0; i < allresume.Total; i++) {
                            var logo = "../images/male.png";
                            if (allresume.ViewResumeList[i].Portrait !== "")
                                logo = allresume.ViewResumeList[i].Portrait;
                            else
                                logo = allresume.ViewResumeList[i].Sex == 1 ? "../images/male.png" : "../images/female.png";

                            var name = allresume.ViewResumeList[i].Name;
                            var age = allresume.ViewResumeList[i].Age;
                            var position = getpositionname(allresume.ViewResumeList[i].Position);
                            var distance = 1;
                            var location = allresume.ViewResumeList[i].Location;
                            var sex = allresume.ViewResumeList[i].Sex == 1 ? "icon icon-man" : "icon icon-women";
                            var id = allresume.ViewResumeList[i].Id;
                            var accid = window.parent.oUserInfo.Id;
                            var pic = allresume.ViewResumeList[i].HasPicture == true ? "withdetail" : "";
                            var video = allresume.ViewResumeList[i].HasVideo == true ? "withdetail" : "";
                            html += temp.replace("{$logo}", logo).replace("{$name}", name).replace("{$age}", age).replace("{$position}", position).replace("{$distance}", distance).replace("{$location}", location).replace("{$sex}", sex).replace("{$id}", id).replace("{$accid}", accid).replace("{$pic}", pic).replace("{$video}", video);
                        }
                        $("#resumelist").html(html);
                        iDataCount = allresume.Total;

                        var optInit = {
                            callback: fShowdata,
                            items_per_page: pagesize,
                            num_display_entries: 5,
                            prev_text: "Prev",
                            next_text: "Next"
                        };
                        $("#Pagination").pagination(iDataCount, optInit);
                        if (iDataCount > pagesize)
                            $("#searchPage").show();
                        else
                            $("#searchPage").hide();

                    } else {
                        $("#divcontent").hide();
                        $("#divnolist").show();
                    }
                }
                else {
                    alert('错误代码：' + resp.code + '；错误信息：' + resp.msg);
                }
            });
            return true;
        }
    </script>
</body>
</html>